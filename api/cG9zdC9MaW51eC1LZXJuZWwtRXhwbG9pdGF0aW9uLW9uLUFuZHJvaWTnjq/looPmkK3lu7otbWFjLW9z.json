{"title":"Linux Kernel Exploitation on Android环境搭建(mac os)","date":"2018-06-26T08:01:24.000Z","slug":"Linux-Kernel-Exploitation-on-Android环境搭建-mac-os","updated":"2018-07-03T08:18:24.000Z","content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>在公司要开始做安卓的内核漏洞挖掘,在网上找到一个android的漏洞挖掘环境靶场,废话不多,先搭环境先.<br>项目的地址:<a href=\"https://github.com/Fuzion24/AndroidKernelExploitationPlayground\" target=\"_blank\" rel=\"noopener\">https://github.com/Fuzion24/AndroidKernelExploitationPlayground</a></p>\n<h3 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h3><p>阅读readme,发现基本上手把手教学,按照流程走一波基本上ok.但是这里有个问题的是<br><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android create avd --force -t <span class=\"string\">\"Google Inc.:Google APIs:19\"</span> -n kernel_challenges</span><br></pre></td></tr></table></figure></p>\n<p>无法成功,自己捣鼓了一下,以下流程可以获得成功.</p>\n<p>打开android studio,利用avd manager创建一个api为19的nexes 5x.<br><img src=\"/img/1.png\" alt=\"我是图片\"><br>打开sdk-manager,安装如下的东西:<br><img src=\"/img/2.png\" alt=\"我是图片\"><br>保证emulator等版本对上,保证将其加入环境变量等操作.(我下了一个比较早的sdk版本,替换了最新的emulator)<br><img src=\"/img/3.png\" alt=\"我是图片\"></p>\n<p>还有如下的操作:<br><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp elfutils/<span class=\"number\">0.153</span>/libelf/elf.h /usr/local/include</span><br></pre></td></tr></table></figure></p>\n<p>将0.153删除,之后编译的时候还会提示缺少很多头文件,我们去ubuntu的目录下去寻找即可.<br>然后按照教程执行:<br><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">emulator -show-kernel -kernel arch/arm/boot/zImage -avd Nexus_5X_API_19 -no-boot-anim -no-skin -no-audio -no-window -qemu -monitor unix:/tmp/qemuSocket,server,nowait -s</span><br></pre></td></tr></table></figure></p>\n<p><img src=\"/img/4.png\" alt=\"我是图片\"><br>可以看到环境已经启动.terminal中输入adb shell,输入ls /proc, 发现stack_buffer_overflow的存在<br><img src=\"/img/5.png\" alt=\"我是图片\"><br>输入<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot; &gt; /proc/stack_buffer_overflow</span><br></pre></td></tr></table></figure></p>\n<p>发现系统内核崩溃.<br><img src=\"/img/6.png\" alt=\"我是图片\"></p>\n<h3 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h3><p><a href=\"https://stackoverflow.com/questions/7412548/error-gnu-stubs-32-h-no-such-file-or-directory-while-compiling-nachos-source\" target=\"_blank\" rel=\"noopener\">https://stackoverflow.com/questions/7412548/error-gnu-stubs-32-h-no-such-file-or-directory-while-compiling-nachos-source</a><br><a href=\"https://github.com/Fuzion24/AndroidKernelExploitationPlayground/blob/master/Readme.md\" target=\"_blank\" rel=\"noopener\">https://github.com/Fuzion24/AndroidKernelExploitationPlayground/blob/master/Readme.md</a></p>\n","prev":{"title":"Linux Kernel Exploitation on Android-Stack Buffer overflow","slug":"Linux-Kernel-Exploitation-on-Android-Stack-Buffer-overflow"},"next":{"title":"Asis CTF 2016 b00ks","slug":"Asis-CTF-2016-b00ks"},"link":"https://foyjog.github.io/post/Linux-Kernel-Exploitation-on-Android环境搭建-mac-os/"}