<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  
  
  <title>  Ddctf2018-&#x90E8;&#x5206;Writeup |   gogogo!!! </title>

 
  
    <link rel="icon" href="/images/favicon.png">
  


  <link rel="stylesheet" href="/nayo.min.css"> 
</head>  
  <body>   
    
      <header class="header">
	
  <nav class="header-nav">        
   
    <span class="iconfont icon-menu mobile-toggle"></span>   	

    <a class="header-logo" href="/">foyjog</a>  

    <div class="header-menu">          
              
            

              <a class="header-menu-link" id="header-menu-home" href="/">Home</a>     

            
            
            

              <a class="header-menu-link" id="header-menu-archives" href="/archives">Archives</a>     

            
                
    </div>  
    
  </nav>
</header>   

      <div class="container">       
          
          
            <section class="main">  
          

          <article class="post">
  
	<div class="post-header">

	<p class="post-title">	
		ddctf2018-&#x90E8;&#x5206;writeup
	</p>
			

	<div class="meta-info">	
	<span>
		Apr 20, 2018
	</span>

	
	
		<i class="iconfont icon-words"></i>
		<span>
			23172
		</span>
	
</div>

</div> 
	 

	  <div class="post-content slideDownMin">

		

		
	  		<h1 id="&#x256F;&#xB0;&#x25A1;&#xB0;&#xFF09;&#x256F;&#xFE35;-&#x253B;&#x2501;&#x253B;"><a href="#&#x256F;&#xB0;&#x25A1;&#xB0;&#xFF09;&#x256F;&#xFE35;-&#x253B;&#x2501;&#x253B;" class="headerlink" title="(&#x256F;&#xB0;&#x25A1;&#xB0;&#xFF09;&#x256F;&#xFE35; &#x253B;&#x2501;&#x253B;"></a>(&#x256F;&#xB0;&#x25A1;&#xB0;&#xFF09;&#x256F;&#xFE35; &#x253B;&#x2501;&#x253B;</h1><p>&#x60F3;&#x4E86;&#x5F88;&#x4E45;&#xFF0C;&#x5BF9;&#x7740;&#x53D1;&#x5446;&#x4E86;&#x4E00;&#x5929;&#xFF0C;&#x7136;&#x540E;&#x8BD5;&#x4E86;&#x4E0B;&#x504F;&#x79FB;&#x89E3;&#x7801;&#x3002;&#x3002;&#x3002;&#x7136;&#x540E;&#x5C31;&#x5BF9;&#x4E86;&#xFF0C;&#x6BCF;&#x4E2A;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x51CF;&#x53BB;128&#x5373;&#x53EF;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">result = [<span class="number">0xd4</span>,<span class="number">0xe8</span>,<span class="number">0xe1</span>,<span class="number">0xf4</span>,<span class="number">0xa0</span>,<span class="number">0xf7</span>,<span class="number">0xe1</span>,<span class="number">0xf3</span>,<span class="number">0xa0</span>,<span class="number">0xe6</span>,<span class="number">0xe1</span>,<span class="number">0xf3</span>,<span class="number">0xf4</span>,<span class="number">0xa1</span>,<span class="number">0xa0</span>,<span class="number">0xd4</span>,<span class="number">0xe8</span>,<span class="number">0xe5</span>,<span class="number">0xa0</span>,<span class="number">0xe6</span>,<span class="number">0xec</span>,<span class="number">0xe1</span>,<span class="number">0xe7</span>,<span class="number">0xa0</span>,<span class="number">0xe9</span>,<span class="number">0xf3</span>,<span class="number">0xba</span>,<span class="number">0xa0</span>,<span class="number">0xc4</span>,<span class="number">0xc4</span>,<span class="number">0xc3</span>,<span class="number">0xd4</span>,<span class="number">0xc6</span>,<span class="number">0xfb</span>,<span class="number">0xb9</span>,<span class="number">0xb2</span>,<span class="number">0xb2</span>,<span class="number">0xe1</span>,<span class="number">0xe2</span>,<span class="number">0xb9</span>,<span class="number">0xb9</span>,<span class="number">0xb7</span>,<span class="number">0xb4</span>,<span class="number">0xe1</span>,<span class="number">0xb4</span>,<span class="number">0xb7</span>,<span class="number">0xe3</span>,<span class="number">0xe4</span>,<span class="number">0xb3</span>,<span class="number">0xb2</span>,<span class="number">0xb2</span>,<span class="number">0xe3</span>,<span class="number">0xe6</span>,<span class="number">0xb4</span>,<span class="number">0xb3</span>,<span class="number">0xe2</span>,<span class="number">0xb5</span>,<span class="number">0xb0</span>,<span class="number">0xb6</span>,<span class="number">0xb1</span>,<span class="number">0xb0</span>,<span class="number">0xe6</span>,<span class="number">0xe1</span>,<span class="number">0xe5</span>,<span class="number">0xe1</span>,<span class="number">0xb5</span>,<span class="number">0xfd</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result:</span><br><span class="line">    <span class="keyword">print</span> chr(i<span class="number">-128</span>),</span><br></pre></td></tr></table></figure>
<h1 id="&#x7B2C;&#x56DB;&#x6269;&#x5C55;FS"><a href="#&#x7B2C;&#x56DB;&#x6269;&#x5C55;FS" class="headerlink" title="&#x7B2C;&#x56DB;&#x6269;&#x5C55;FS"></a>&#x7B2C;&#x56DB;&#x6269;&#x5C55;FS</h1><p>&#x9898;&#x76EE;&#x6709;&#x6DF7;&#x6DC6;&#xFF0C;&#x4E00;&#x5F00;&#x59CB;&#x4EE5;&#x4E3A;&#x6587;&#x4EF6;&#x4E2D;&#x7684;The fourth extended filesystem&#x662F;&#x63D0;&#x793A;&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x662F;&#x6B63;&#x786E;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x628A;&#x8FD9;&#x4E2A;ext4&#x6587;&#x4EF6;dd&#x51FA;&#x6765;&#xFF0C;&#x7136;&#x540E;&#x6302;&#x8F7D;&#xFF0C;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x6587;&#x4EF6;file.zip&#xFF0C;&#x4F46;&#x662F;&#x4E00;&#x76F4;&#x4EE5;&#x4E3A;&#x662F;&#x6062;&#x590D;&#x6587;&#x4EF6;&#x5565;&#x7684;&#x6765;&#x83B7;&#x53D6;&#x5BC6;&#x7801;&#xFF0C;&#x641E;&#x4E86;&#x597D;&#x4E45;&#x770B;&#x9898;&#x76EE;&#x7684;&#x610F;&#x601D;&#x624D;&#x60F3;&#x5230;&#x5BC6;&#x7801;&#x5728;&#x5907;&#x6CE8;&#x4E2D;&#x3002;&#x3002;&#x3002;&#xFF08;Pactera&#xFF09;&#xFF0C;&#x89E3;&#x538B;&#x5F97;&#x5230;file.txt&#x6587;&#x4EF6;&#xFF0C;&#x6253;&#x5F00;&#x5168;&#x662F;&#x5B57;&#x6BCD;&#xFF0C;&#x6839;&#x636E;&#x9898;&#x76EE;&#x63D0;&#x793A;&#x65E5;&#x5E38;&#x8FDD;&#x89C4;&#x5BA1;&#x8BA1;&#x4E2D;&#x9891;&#x6B21;&#x6709;&#x65F6;&#x5019;&#x975E;&#x5E38;&#x91CD;&#x8981;&#xFF0C;&#x8BA1;&#x7B97;&#x6587;&#x4EF6;&#x4E2D;&#x6BCF;&#x4E2A;&#x5B57;&#x6BCD;&#x7684;&#x9891;&#x6B21;&#xFF0C;&#x7136;&#x540E;&#x6392;&#x5E8F;&#xFF0C;&#x5F97;&#x5230;flag&#x3002;</p>
<h1 id="&#x6D41;&#x91CF;&#x5206;&#x6790;"><a href="#&#x6D41;&#x91CF;&#x5206;&#x6790;" class="headerlink" title="&#x6D41;&#x91CF;&#x5206;&#x6790;"></a>&#x6D41;&#x91CF;&#x5206;&#x6790;</h1><p>&#x63D0;&#x793A;&#x4E3A;</p>
<blockquote>
<p>&#x63D0;&#x793A;&#x4E8C;&#xFF1A;&#x6CE8;&#x610F;&#x8865;&#x9F50;&#x79C1;&#x94A5;&#x683C;&#x5F0F;&#x2014;&#x2013;BEGIN RSA PRIVATE KEY&#x2014;&#x2013;XXXXXXX&#x2014;&#x2013;END RSA PRIVATE KEY&#x2014;&#x2013;</p>
</blockquote>
<p>&#x7814;&#x7A76;ssl&#x4F20;&#x8F93;&#x6D41;&#xFF0C;&#x4F46;&#x662F;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x79C1;&#x94A5;&#xFF0C;&#x5F80;&#x6D41;&#x7684;&#x524D;&#x9762;&#x7FFB;&#xFF0C;&#x770B;&#x5230;&#x4E00;&#x4E2A;mime&#x7684;&#x90AE;&#x4EF6;&#x5185;&#x5BB9;&#x4E3A;:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">=20</span><br><span class="line"></span><br><span class="line">=20</span><br><span class="line"></span><br><span class="line">=E5=B0=8F=E5=BC=A0=E4=BD=A0=E5=A5=BD=EF=BC=9A</span><br><span class="line"></span><br><span class="line">=20</span><br><span class="line"></span><br><span class="line">=20</span><br><span class="line"></span><br><span class="line">=E4=BD=A0=E5=A5=BD=EF=BC=8C=E8=AF=B7=E4=BD=A0=E5=B0=86=E5=AF=86=E9=92=A5=E5=AE=89=E8=A3=85=E5=88=B0=E6=9C=8D=E5=8A=A1=E5=99=A8=E4=B8=8A=E3=80=82=E8=B0=A2=E8=B0=A2</span><br><span class="line"></span><br><span class="line">=20</span><br><span class="line"></span><br><span class="line">=20</span><br><span class="line"></span><br><span class="line">=20</span><br></pre></td></tr></table></figure>
<p>&#x89E3;&#x7801;&#x610F;&#x601D;&#x5982;&#x4E0B;&#xFF1A;&#x5C0F;&#x5F20;&#x4F60;&#x597D;&#xFF1A;&#x4F60;&#x597D;&#xFF0C;&#x8BF7;&#x4F60;&#x5C06;&#x5BC6;&#x94A5;&#x5B89;&#x88C5;&#x5230;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x3002;&#x8C22;&#x8C22;<br>&#x968F;&#x540E;&#x7FFB;&#x5230;&#x4E0B;&#x9762;&#x7684;&#x4E00;&#x5F20;base64&#x52A0;&#x5BC6;&#x7684;&#x56FE;&#x7247;&#xFF0C;&#x89E3;&#x5BC6;&#x5F97;&#x5230;&#x79C1;&#x94A5;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIICXAIBAAKBgQDCm6vZmclJrVH1AAyGuCuSSZ8O+mIQiOUQCvN0HYbj8153JfSQ</span><br><span class="line">LsJIhbRYS7+zZ1oXvPemWQDv/u/tzegt58q4ciNmcVnq1uKiygc6QOtvT7oiSTyO</span><br><span class="line">vMX/q5iE2iClYUIHZEKX3BjjNDxrYvLQzPyGD1EY2DZIO6T45FNKYC2VDwIDAQAB</span><br><span class="line">AoGAbtWUKUkx37lLfRq7B5sqjZVKdpBZe4tL0jg6cX5Djd3Uhk1inR9UXVNw4/y4</span><br><span class="line">QGfzYqOn8+Cq7QSoBysHOeXSiPztW2cL09ktPgSlfTQyN6ELNGuiUOYnaTWYZpp/</span><br><span class="line">QbRcZ/eHBulVQLlk5M6RVs9BLI9X08RAl7EcwumiRfWas6kCQQDvqC0dxl2wIjwN</span><br><span class="line">czILcoWLig2c2u71Nev9DrWjWHU8eHDuzCJWvOUAHIrkexddWEK2VHd+F13GBCOQ</span><br><span class="line">ZCM4prBjAkEAz+ENahsEjBE4+7H1HdIaw0+goe/45d6A2ewO/lYH6dDZTAzTW9z9</span><br><span class="line">kzV8uz+Mmo5163/JtvwYQcKF39DJGGtqZQJBAKa18XR16fQ9TFL64EQwTQ+tYBzN</span><br><span class="line">+04eTWQCmH3haeQ/0Cd9XyHBUveJ42Be8/jeDcIx7dGLxZKajHbEAfBFnAsCQGq1</span><br><span class="line">AnbJ4Z6opJCGu+UP2c8SC8m0bhZJDelPRC8IKE28eB6SotgP61ZqaVmQ+HLJ1/wH</span><br><span class="line">/5pfc3AmEyRdfyx6zwUCQCAH4SLJv/kprRz1a1gx8FR5tj4NeHEFFNEgq1gmiwmH</span><br><span class="line">2STT5qZWzQFz8NRe+/otNOHBR2Xk4e8IS+ehIJ3TvyE=</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure></p>
<p>&#x901A;&#x8FC7;wireshark&#x672C;&#x8EAB;&#x7684;&#x89E3;&#x5BC6;&#x529F;&#x80FD;&#xFF0C;&#x5F97;&#x5230;flag&#xFF1A; DDCTF{efd2a79ae9ae5008694a3561fb55470e}</p>
<h1 id="&#x5B89;&#x5168;&#x901A;&#x4FE1;"><a href="#&#x5B89;&#x5168;&#x901A;&#x4FE1;" class="headerlink" title="&#x5B89;&#x5168;&#x901A;&#x4FE1;"></a>&#x5B89;&#x5168;&#x901A;&#x4FE1;</h1><p>&#x8FD9;&#x4E2A;&#x9898;&#x76EE;&#x770B;&#x61C2;python&#x5373;&#xFF0C;sha1&#x52A0;&#x5BC6;&#xFF0C;&#x52A0;&#x5BC6;&#x4F4D;&#x6570;&#x4E3A;16&#x4F4D;&#xFF0C;&#x6240;&#x4EE5;&#x901A;&#x8FC7;agentid&#x6765;&#x4E0D;&#x65AD;&#x4F7F;&#x6574;&#x4E2A;&#x8F93;&#x5165;&#x4F4D;&#x6570;&#x589E;&#x957F;&#x6216;&#x8005;&#x51CF;&#x5C11;&#x5373;&#x53EF;&#x5B9E;&#x73B0;&#x89E3;&#x5BC6;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">angent_ID = <span class="string">&quot;11111111&quot;</span></span><br><span class="line">flag = [<span class="number">31</span>]*<span class="number">33</span></span><br><span class="line">result = <span class="string">&apos;&apos;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count != <span class="number">-1</span>:</span><br><span class="line">    p = remote(<span class="string">&quot;116.85.48.103&quot;</span>,<span class="number">5002</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">&quot;f49348cf84d390da52498077ae7137d5&quot;</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(angent_ID)</span><br><span class="line">    ret =  p.recvline()</span><br><span class="line">    p.recv()</span><br><span class="line">    last32 = ret[len(ret)<span class="number">-33</span><span class="number">-32</span><span class="number">-32</span>:len(ret)<span class="number">-33</span><span class="number">-32</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:   </span><br><span class="line">        msg = <span class="string">&quot;Connection for mission: &quot;</span>+angent_ID+<span class="string">&quot;, your mission&apos;s flag is: DDCTF{&quot;</span> </span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> flag:</span><br><span class="line">            msg +=x</span><br><span class="line">        p.sendline(msg)</span><br><span class="line">        ret =  p.recvline()</span><br><span class="line">        last32_1 = ret[len(ret)<span class="number">-33</span><span class="number">-32</span><span class="number">-32</span>:len(ret)<span class="number">-1</span><span class="number">-32</span><span class="number">-32</span>]</span><br><span class="line">        <span class="keyword">if</span> last32_1 == last32:</span><br><span class="line">            result += flag[count]</span><br><span class="line">            count = count - <span class="number">1</span> </span><br><span class="line">            angent_ID += <span class="string">&apos;1&apos;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        flag[count] = chr(ord(flag[count])+<span class="number">1</span>)</span><br><span class="line">        p.recv()</span><br><span class="line">    p.close()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>   result[::<span class="number">-1</span>]</span><br></pre></td></tr></table></figure></p>
<p>&#x4EE3;&#x7801;&#x662F;&#x6700;&#x540E;&#x5F97;&#x51FA;&#x4E00;&#x90E8;&#x5206;flag&#x7684;&#x4FEE;&#x6539;&#x7248;&#x672C;&#xFF0C;&#x6240;&#x4EE5;&#x5E94;&#x8BE5;&#x53EA;&#x80FD;&#x8DD1;&#x51FA;flag&#x7684;&#x7B2C;&#x4E00;&#x4F4D;&#xFF0C;&#x8981;&#x8DD1;&#x51FA;&#x5176;&#x4ED6;&#x7A0D;&#x52A0;&#x53D8;&#x6362;&#x5373;&#x53EF;&#x3002;</p>
<h1 id="Baby-MIPS"><a href="#Baby-MIPS" class="headerlink" title="Baby MIPS"></a>Baby MIPS</h1><p>&#x9898;&#x76EE;&#x5F88;&#x5751;&#xFF0C;&#x7ADF;&#x7136;&#x662F;&#x4E00;&#x4E2A;&#x4E0D;&#x80FD;&#x8FD0;&#x884C;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x65F6;&#x95F4;&#x90FD;&#x82B1;&#x5728;&#x8003;&#x8651;&#x5982;&#x4F55;&#x8BA9;&#x5B83;&#x8DD1;&#x8D77;&#x6765;&#x4E86;&#xFF0C;&#x540E;&#x6765;&#x653E;&#x5F03;&#x4E4B;&#x540E;&#x8BA4;&#x771F;&#x770B;&#x4E86;&#x4E0B;&#x8FD9;&#x4E00;&#x6BB5;&#x975E;&#x5E38;&#x957F;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x624D;&#x53D1;&#x73B0;&#x662F;&#x4E00;&#x4E2A;16<em>16&#x7684;&#x7EBF;&#x6027;&#x65B9;&#x7A0B;&#x7EC4;&#xFF0C;&#x662F;&#x771F;&#x6EF4;&#x5751;&#x3002;<br>&#x4E0B;&#x9762;&#x662F;&#x83B7;&#x53D6;16</em>16&#x53C2;&#x6570;&#x548C;16&#x4E2A;&#x7ED3;&#x679C;&#x7684;idapython&#xFF1A;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">start = <span class="number">0x400430</span></span><br><span class="line">end = <span class="number">0x4017a9</span></span><br><span class="line">end2 = <span class="number">0x004017A8</span></span><br><span class="line">op = <span class="string">&apos;&apos;</span></span><br><span class="line">v0 = <span class="number">0</span></span><br><span class="line">number = <span class="number">8</span></span><br><span class="line">result = <span class="number">1028</span>*[<span class="number">1</span>]  </span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> range(start,end2):</span><br><span class="line">    <span class="keyword">if</span> GetOpnd(line,<span class="number">2</span>) != <span class="string">&apos;&apos;</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    opnd1 = str(hex(number + <span class="number">4</span>))+<span class="string">&apos;($fp)&apos;</span></span><br><span class="line">    <span class="keyword">if</span>(idc.GetOpnd(line,<span class="number">1</span>).lower() == opnd1):</span><br><span class="line">        number = number + <span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;sw&apos;</span>:</span><br><span class="line">        result[number] = v0</span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;li&apos;</span>:</span><br><span class="line">        v0 = int(GetOpnd(line,<span class="number">1</span>),<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;lw&apos;</span>:</span><br><span class="line">        v0 = result[number]</span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;sra&apos;</span>:</span><br><span class="line">        n = int(GetOpnd(line,<span class="number">1</span>),<span class="number">16</span>)</span><br><span class="line">        v0 = v0 &gt;&gt; n</span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;xori&apos;</span>:</span><br><span class="line">        n = int(GetOpnd(line,<span class="number">1</span>),<span class="number">16</span>)</span><br><span class="line">        v0 = v0 ^ n</span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;sll&apos;</span>:</span><br><span class="line">        n = int(GetOpnd(line,<span class="number">1</span>),<span class="number">16</span>)</span><br><span class="line">        v0 = v0 &lt;&lt; n</span><br><span class="line">  </span><br><span class="line">j = <span class="number">0</span>      </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>,len(result)/<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">print</span> hex(result[i*<span class="number">4</span>]),</span><br><span class="line">    j = j +<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> j%<span class="number">16</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&apos;&apos;</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">start = <span class="number">0x400430</span></span><br><span class="line">end = <span class="number">0x004017A8</span></span><br><span class="line">op = <span class="string">&apos;&apos;</span></span><br><span class="line">v0 = <span class="number">0</span></span><br><span class="line">number = <span class="number">8</span></span><br><span class="line">result = <span class="number">1028</span>*[<span class="number">1</span>] </span><br><span class="line">result2 = [] </span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> range(start,end):</span><br><span class="line">    <span class="keyword">if</span> GetOpnd(line,<span class="number">2</span>) != <span class="string">&apos;&apos;</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    opnd1 = str(hex(number + <span class="number">4</span>))+<span class="string">&apos;($fp)&apos;</span></span><br><span class="line">    <span class="keyword">if</span>(idc.GetOpnd(line,<span class="number">1</span>).lower() == opnd1):</span><br><span class="line">        number = number + <span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;sw&apos;</span>:</span><br><span class="line">        result[number] = v0</span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;li&apos;</span>:</span><br><span class="line">        v0 = int(GetOpnd(line,<span class="number">1</span>),<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;lw&apos;</span>:</span><br><span class="line">        v0 = result[number]</span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;sra&apos;</span>:</span><br><span class="line">        n = int(GetOpnd(line,<span class="number">1</span>),<span class="number">16</span>)</span><br><span class="line">        v0 = v0 &gt;&gt; n</span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;xori&apos;</span>:</span><br><span class="line">        n = int(GetOpnd(line,<span class="number">1</span>),<span class="number">16</span>)</span><br><span class="line">        v0 = v0 ^ n</span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;sll&apos;</span>:</span><br><span class="line">        n = int(GetOpnd(line,<span class="number">1</span>),<span class="number">16</span>)</span><br><span class="line">        v0 = v0 &lt;&lt; n</span><br><span class="line"></span><br><span class="line">start = <span class="number">0x004017B0</span>  </span><br><span class="line">end = <span class="number">0x0040312C</span></span><br><span class="line"></span><br><span class="line">number = <span class="number">8</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> range(start,end):</span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;lw&apos;</span>:</span><br><span class="line">        <span class="keyword">if</span> idc.GetOpnd(line,<span class="number">0</span>) == <span class="string">&quot;$v1&quot;</span>:</span><br><span class="line">            number = number + <span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;negu&apos;</span>:</span><br><span class="line">        result[number] = - result[number]</span><br><span class="line">        number = number + <span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;subu&apos;</span>:</span><br><span class="line">        result[number] = - result[number]</span><br><span class="line">        number = number + <span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;addu&apos;</span>:</span><br><span class="line">        number = number + <span class="number">4</span></span><br><span class="line">    <span class="keyword">if</span> idc.GetMnem(line) == <span class="string">&apos;li&apos;</span>:</span><br><span class="line">        <span class="keyword">if</span> idc.GetOpnd(line,<span class="number">0</span>) == <span class="string">&quot;$v0&quot;</span>:</span><br><span class="line">            result2.append(GetOpnd(line,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> result2:</span><br><span class="line">    <span class="keyword">print</span> x,</span><br></pre></td></tr></table></figure></p>
<p>&#x5F97;&#x51FA;&#x53C2;&#x6570;&#x540E;&#x7528;python&#x89E3;&#x65B9;&#x7A0B;&#xFF1A;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">A = np.array([[<span class="number">-0xdbbb</span>,<span class="number">0xfbf1</span>,<span class="number">-0xf15b</span>,<span class="number">0x7529</span>,<span class="number">-0x41d5</span>,<span class="number">0x863</span>,<span class="number">-0xcb16</span>,<span class="number">-0x8db6</span>,<span class="number">-0x853c</span>,<span class="number">-0x47c</span>,<span class="number">0x706</span>,<span class="number">-0xa9bc</span>,<span class="number">-0x3f16</span>,<span class="number">-0xdb17</span>,<span class="number">-0x450d</span>,<span class="number">-0xa318</span>],</span><br><span class="line">[<span class="number">-0x99ba</span>,<span class="number">0xf90a</span>,<span class="number">0xc551</span>,<span class="number">0x95c</span>,<span class="number">-0x9248</span>,<span class="number">0xaa41</span>,<span class="number">0x4c0c</span>,<span class="number">-0x1250</span>,<span class="number">-0xf595</span>,<span class="number">-0x50b7</span>,<span class="number">0xa0d5</span>,<span class="number">0xeeb9</span>,<span class="number">0x788e</span>,<span class="number">0x9550</span>,<span class="number">-0x259</span>,<span class="number">0xd28b</span>],</span><br><span class="line">[<span class="number">0x68ae</span>,<span class="number">-0xe608</span>,<span class="number">0x3a51</span>,<span class="number">-0x54f7</span>,<span class="number">-0x3061</span>,<span class="number">0xda99</span>,<span class="number">-0x50ea</span>,<span class="number">0x6141</span>,<span class="number">0x9c6d</span>,<span class="number">0x264d</span>,<span class="number">0x623b</span>,<span class="number">0x9b21</span>,<span class="number">-0x55c0</span>,<span class="number">-0xa758</span>,<span class="number">0x9431</span>,<span class="number">-0x216f</span>],</span><br><span class="line">[<span class="number">-0xae5</span>,<span class="number">0xd06f</span>,<span class="number">0x416b</span>,<span class="number">0xd3b3</span>,<span class="number">-0x7544</span>,<span class="number">0x9bec</span>,<span class="number">-0x7f46</span>,<span class="number">0xebb2</span>,<span class="number">0x3693</span>,<span class="number">0x6aab</span>,<span class="number">-0x7714</span>,<span class="number">0xbad2</span>,<span class="number">0x92b2</span>,<span class="number">0xfd92</span>,<span class="number">-0x6d1</span>,<span class="number">0x6c15</span>],</span><br><span class="line">[<span class="number">0x9db6</span>,<span class="number">0x197b</span>,<span class="number">0x3444</span>,<span class="number">-0xd0a5</span>,<span class="number">-0x4aa</span>,<span class="number">0x1e74</span>,<span class="number">-0x7c47</span>,<span class="number">-0xca9a</span>,<span class="number">-0x9d3c</span>,<span class="number">-0xde33</span>,<span class="number">0xe1d3</span>,<span class="number">0x5aee</span>,<span class="number">-0x1699</span>,<span class="number">0xf055</span>,<span class="number">-0x1b48</span>,<span class="number">-0x1ca7</span>],</span><br><span class="line">[<span class="number">-0xdedc</span>,<span class="number">-0xfc3d</span>,<span class="number">-0xf38f</span>,<span class="number">0xa44</span>,<span class="number">0x53f5</span>,<span class="number">0x328b</span>,<span class="number">-0xea66</span>,<span class="number">0x1b3</span>,<span class="number">0x3aa1</span>,<span class="number">-0xffb</span>,<span class="number">0x58d7</span>,<span class="number">0x1325</span>,<span class="number">0xbea3</span>,<span class="number">-0xa8c3</span>,<span class="number">0x148f</span>,<span class="number">-0x80e2</span>],</span><br><span class="line">[<span class="number">0xd5e8</span>,<span class="number">0xa05d</span>,<span class="number">0x5809</span>,<span class="number">-0xdc99</span>,<span class="number">0xb4ec</span>,<span class="number">0x4d4b</span>,<span class="number">-0x9cf4</span>,<span class="number">0x828</span>,<span class="number">0x7fc</span>,<span class="number">0x67cf</span>,<span class="number">-0x1457</span>,<span class="number">0x797a</span>,<span class="number">-0x5d1e</span>,<span class="number">0x548a</span>,<span class="number">0xb69e</span>,<span class="number">0x358a</span>],</span><br><span class="line">[<span class="number">-0x9cf0</span>,<span class="number">-0xa976</span>,<span class="number">0xbe4e</span>,<span class="number">-0x634f</span>,<span class="number">0x53cc</span>,<span class="number">-0x8f6a</span>,<span class="number">-0x5e37</span>,<span class="number">-0x33af</span>,<span class="number">-0xcbe0</span>,<span class="number">0xc24e</span>,<span class="number">0xd5b5</span>,<span class="number">-0x7f7c</span>,<span class="number">0x4f09</span>,<span class="number">0x53d4</span>,<span class="number">0xbe5d</span>,<span class="number">0x3b33</span>],</span><br><span class="line">[<span class="number">0x962e</span>,<span class="number">-0x370</span>,<span class="number">-0x98b</span>,<span class="number">0xc537</span>,<span class="number">-0xb77d</span>,<span class="number">-0xdb72</span>,<span class="number">-0x9112</span>,<span class="number">-0x2377</span>,<span class="number">-0x4a98</span>,<span class="number">-0xee3c</span>,<span class="number">-0x71f</span>,<span class="number">-0x5422</span>,<span class="number">0xab78</span>,<span class="number">-0x102d</span>,<span class="number">-0x4baa</span>,<span class="number">-0xbab4</span>],</span><br><span class="line">[<span class="number">0x1438</span>,<span class="number">0x47e0</span>,<span class="number">-0xd25c</span>,<span class="number">0x8d17</span>,<span class="number">-0x7d78</span>,<span class="number">0xba6c</span>,<span class="number">0x4302</span>,<span class="number">0x150e</span>,<span class="number">-0x7415</span>,<span class="number">0x3887</span>,<span class="number">0x2233</span>,<span class="number">0x598</span>,<span class="number">-0xb1ce</span>,<span class="number">-0x1fd4</span>,<span class="number">-0xdd2f</span>,<span class="number">-0xbc7e</span>],</span><br><span class="line">[<span class="number">0x75fb</span>,<span class="number">-0xc618</span>,<span class="number">-0x6ba8</span>,<span class="number">-0x3ecb</span>,<span class="number">0xe22</span>,<span class="number">0x24e</span>,<span class="number">0xad11</span>,<span class="number">0x5065</span>,<span class="number">0x82a2</span>,<span class="number">-0x1e3f</span>,<span class="number">-0xa843</span>,<span class="number">-0x3f6a</span>,<span class="number">0xb29b</span>,<span class="number">-0xaf63</span>,<span class="number">0xa551</span>,<span class="number">0xc070</span>],</span><br><span class="line">[<span class="number">0xa6d1</span>,<span class="number">-0x7e2b</span>,<span class="number">-0x4ad4</span>,<span class="number">0x15da</span>,<span class="number">0x70c6</span>,<span class="number">0x1f7b</span>,<span class="number">0xe2f7</span>,<span class="number">-0xed33</span>,<span class="number">-0x7d70</span>,<span class="number">-0x1bd8</span>,<span class="number">0xb3a1</span>,<span class="number">-0x6153</span>,<span class="number">0xf9a6</span>,<span class="number">0x47fb</span>,<span class="number">-0xc8d0</span>,<span class="number">0x585b</span>],</span><br><span class="line">[<span class="number">-0xe0ad</span>,<span class="number">0x5102</span>,<span class="number">-0x7e1e</span>,<span class="number">0xdabb</span>,<span class="number">0x682a</span>,<span class="number">0x92ae</span>,<span class="number">-0xc921</span>,<span class="number">0x35a5</span>,<span class="number">0x7ec7</span>,<span class="number">-0xb51</span>,<span class="number">-0x9ac6</span>,<span class="number">-0xd4fb</span>,<span class="number">0xc62d</span>,<span class="number">-0x6049</span>,<span class="number">-0x45b9</span>,<span class="number">-0xf376</span>],</span><br><span class="line">[<span class="number">-0x3d64</span>,<span class="number">-0x9578</span>,<span class="number">0xfbdc</span>,<span class="number">-0x9294</span>,<span class="number">-0xf06f</span>,<span class="number">0x34e0</span>,<span class="number">0x3278</span>,<span class="number">0x57f</span>,<span class="number">-0xf917</span>,<span class="number">-0xd741</span>,<span class="number">-0xb5cf</span>,<span class="number">-0x8ed2</span>,<span class="number">-0x50e8</span>,<span class="number">0x80f</span>,<span class="number">-0x1a0c</span>,<span class="number">0x2372</span>],</span><br><span class="line">[<span class="number">0xb982</span>,<span class="number">0x48b3</span>,<span class="number">0xccc0</span>,<span class="number">0xc23</span>,<span class="number">0x7db1</span>,<span class="number">-0xa334</span>,<span class="number">0x2b00</span>,<span class="number">0x1c37</span>,<span class="number">0x1614</span>,<span class="number">0x371</span>,<span class="number">0x685f</span>,<span class="number">-0x6f1c</span>,<span class="number">0xb3fd</span>,<span class="number">-0x110</span>,<span class="number">-0x7edb</span>,<span class="number">-0x24d8</span>],</span><br><span class="line">[<span class="number">-0xe63a</span>,<span class="number">-0x8b69</span>,<span class="number">0x8b7c</span>,<span class="number">0xae91</span>,<span class="number">0xb34e</span>,<span class="number">0x8f06</span>,<span class="number">0x9696</span>,<span class="number">0x2db</span>,<span class="number">0xc346</span>,<span class="number">0x1a47</span>,<span class="number">0xf056</span>,<span class="number">-0x8b03</span>,<span class="number">-0x991f</span>,<span class="number">-0xab6e</span>,<span class="number">-0xdc59</span>,<span class="number">-0x63af</span>]])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">B = np.array([<span class="number">0xFE8E3EBA</span>, <span class="number">0x1061309</span> ,<span class="number">0x84D6C3</span>, <span class="number">0x19B6934</span>, <span class="number">0xFF9E94D4</span>, <span class="number">0xFF141D3B</span>, <span class="number">0x12A6103</span>, <span class="number">0xFFFD20AD</span>, <span class="number">0xFED51449</span> ,<span class="number">0xFF3D61C1</span>, <span class="number">0x624DA6</span>, <span class="number">0xFFD43532</span>, <span class="number">0xFFB6AD60</span>, <span class="number">0xFEDEA130</span>, <span class="number">0x8862D9</span>,<span class="number">0x3B7496</span>])</span><br><span class="line"></span><br><span class="line">B2 = np.array([<span class="number">-24232262</span>, <span class="number">0x1061309</span> ,<span class="number">0x84D6C3</span>, <span class="number">0x19B6934</span>, <span class="number">-6384428</span>, <span class="number">-15459013</span>, <span class="number">0x12A6103</span>, <span class="number">-188243</span>, <span class="number">-19590071</span> ,<span class="number">-12754495</span>, <span class="number">0x624DA6</span>, <span class="number">-2869966</span>, <span class="number">-4805280</span>, <span class="number">-18964176</span>, <span class="number">0x8862D9</span>,<span class="number">0x3B7496</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x = np.linalg.solve(A, B2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> ((x))</span><br></pre></td></tr></table></figure></p>
<h1 id="&#x9ED1;&#x76D2;&#x7834;&#x89E3;"><a href="#&#x9ED1;&#x76D2;&#x7834;&#x89E3;" class="headerlink" title="&#x9ED1;&#x76D2;&#x7834;&#x89E3;"></a>&#x9ED1;&#x76D2;&#x7834;&#x89E3;</h1><p>&#x8FD9;&#x9898;&#x76EE;&#x5E94;&#x8BE5;&#x662F;&#x6700;&#x6709;&#x610F;&#x601D;&#x7684;&#x4E00;&#x4E2A;&#x9898;&#x76EE;&#x4E86;,&#x6574;&#x4E2A;&#x51FD;&#x6570;&#x5C31;&#x56F4;&#x7ED5;&#x7740; new2720_v4 = (struct_a1 *)operator new(0xAA0uLL);&#x6574;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x5C55;&#x5F00;&#xFF0C;&#x91CD;&#x70B9;&#x5B9E;&#x5728;&#x89E3;&#x5BC6;&#x51FA;&#x6BCF;&#x4E2A;&#x5B57;&#x6BCD;&#x5BF9;&#x5E94;&#x7684;&#x51FD;&#x6570;<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">sub_401A48</span><span class="params">(struct_a1 *new2720_v4_2)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="keyword">char</span> v2; <span class="comment">// [rsp+13h] [rbp-1Dh]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+14h] [rbp-1Ch]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( new2720_v4_2 &amp;&amp; new2720_v4_2 != (struct_a1 *)<span class="number">-16L</span>L )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(new2720_v4_2-&gt;passcode); ++i )</span><br><span class="line">    {</span><br><span class="line">      v2 = new2720_v4_2-&gt;passcode[i];</span><br><span class="line">      <span class="keyword">if</span> ( i + <span class="number">1</span> != <span class="built_in">strlen</span>(new2720_v4_2-&gt;passcode) )</span><br><span class="line">        new2720_v4_2-&gt;byte298 = new2720_v4_2-&gt;passcode[i + <span class="number">1</span>];</span><br><span class="line">      <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">8</span>; ++j )</span><br><span class="line">      {</span><br><span class="line">        <span class="keyword">if</span> ( byte_603900[v2] != *((_BYTE *)&amp;new2720_v4_2-&gt;dword198</span><br><span class="line">                                + *((<span class="keyword">signed</span> <span class="keyword">int</span> *)&amp;new2720_v4_2-&gt;input_str_encode + j + <span class="number">72L</span>L)) )</span><br><span class="line">        {</span><br><span class="line">          new2720_v4_2-&gt;qword2A0 = *(&amp;new2720_v4_2-&gt;input_str_encode</span><br><span class="line">                                   + *((<span class="keyword">signed</span> <span class="keyword">int</span> *)&amp;new2720_v4_2-&gt;input_str_encode + j + <span class="number">72L</span>L)</span><br><span class="line">                                   + <span class="number">84L</span>L);</span><br><span class="line">          ((<span class="keyword">void</span> (__fastcall *)(struct_a1 *))new2720_v4_2-&gt;qword2A0)(new2720_v4_2);</span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x8BA4;&#x771F;&#x5206;&#x6790;&#x662F;&#x6BD4;&#x8F83;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#xFF0C;&#x7136;&#x540E;&#x8DDF;&#x516B;&#x4E2A;opcode&#x53BB;&#x6BD4;&#x8F83;&#xFF0C;&#x662F;&#x54EA;&#x4E2A;&#x5C31;&#x6267;&#x884C;&#x54EA;&#x4E2A;&#x51FD;&#x6570;&#xFF1A;&#x516B;&#x4E2A;&#x51FD;&#x6570;&#x5C31;&#x4E0D;&#x8D34;&#x4E86;&#xFF0C;&#x516B;&#x4E2A;opcode&#x5206;&#x522B;&#x662F;&#xFF1A;$  0  C  E  8  t  u  ;  #<br>&#x55EF;&#xFF0C;&#x5206;&#x6790;&#x6BCF;&#x4E2A;opcode&#x7684;&#x51FD;&#x6570;&#x76F8;&#x5E94;&#x7684;&#x64CD;&#x4F5C;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF1A;<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$&#xFF1A; a1-&gt;<span class="number">299</span> = *(a1-&gt;<span class="number">120</span>+a1-&gt;<span class="number">8</span>) </span><br><span class="line"><span class="number">0</span>:  ++(a1-&gt;<span class="number">120</span>)</span><br><span class="line"><span class="number">8</span>:  *(a1-&gt;<span class="number">120</span>+a1-&gt;<span class="number">8</span>) = a1-&gt;<span class="number">299</span></span><br><span class="line">C:  a1-&gt;<span class="number">299</span> = a1-&gt;<span class="number">299</span> + a1-&gt;<span class="number">298</span> - <span class="number">33</span></span><br><span class="line">E:  &#x5173;&#x952E;&#x8F93;&#x51FA;&#x51FD;&#x6570;&#xFF0C;<span class="keyword">if</span> ( a1-&gt;byte298 == <span class="number">0x73</span> ),&#x8F93;&#x51FA;</span><br><span class="line">t:  a1-&gt;<span class="number">299</span> = a1-&gt;<span class="number">299</span> - a1-&gt;<span class="number">298</span> + <span class="number">33</span></span><br><span class="line">u:  --(a1-&gt;<span class="number">120</span>)</span><br><span class="line">;   <span class="keyword">for</span> ( i = <span class="number">0</span>; (<span class="keyword">char</span>)a1-&gt;byte298 &gt; i; ++i )</span><br><span class="line">    ++a1-&gt;dword120;</span><br></pre></td></tr></table></figure></p>
<p>&#x9898;&#x76EE;&#x63D0;&#x793A;&#x8981;&#x8F93;&#x51FA;Binggo&#x5373;&#x53EF;,&#x6240;&#x4EE5;&#x8C03;&#x51FA;Binggo&#x5373;&#x53EF;&#x3002;<br>6030e0&#x5730;&#x5740;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PaF0!&amp;Prv}H{ojDQ#7v=2o,wK@8Em/ry2w|n_yWN*z-*sW5vs!&gt;Q8?M&gt;Ue*}&lt;&amp;!c_v?Wz98&gt;79U}LKR&amp;O-3,s2=)!ac&apos;fm,v#WbU5Cv:M&quot;WQa&quot;i%BLT5\&lt;qBI#AK`ixtn+Kn^Ontp]O9Sr(Nm27H}QM&gt;&lt;iE,x)yN?ok]L##jE&quot;-4i-t};AzD4&quot;^iEC\3TrZU)|3:.YLv{7(cnxA_AsYRXyD&amp;|3U_z^yR/Kpqp6lT/pdv8tp,\^Y7T+oLsvf</span><br></pre></td></tr></table></figure></p>
<ol>
<li>a1-&gt;120&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x7528;&#x4F5C;&#x8F93;&#x51FA;&#x7684;&#x504F;&#x79FB;&#xFF0C;&#x5229;&#x7528;0&#x548C;u&#x64CD;&#x4F5C;&#x5355;&#x6B21;&#x6539;&#x53D8;&#x504F;&#x79FB;&#xFF0C;&#x5229;&#x7528;;+&#x504F;&#x79FB;&#x91CF;&#x6765;&#x6307;&#x5B9A;&#x8F83;&#x5927;&#x504F;&#x79FB;&#x91CF;&#x52A0;&#x503C;</li>
<li>*(a1-&gt;120+a1-&gt;8) &#x53EF;&#x4EE5;&#x7528;&#x4F5C;&#x8D4B;&#x503C;&#x7ED9;a1-&gt;299&#x7684;&#x4E2D;&#x95F4;&#x53D8;&#x91CF;</li>
<li>t&#x548C;C+&#x4E00;&#x4E2A;&#x504F;&#x79FB;&#x91CF;&#x53EF;&#x4EE5;&#x7528;&#x4F5C;&#x8F93;&#x5165;&#x8D4B;&#x503C;</li>
<li>&#x5229;&#x7528;8&#x6765;&#x7ED9;6030e0&#x4E2D;a1-&gt;120&#x504F;&#x79FB;&#x8D4B;&#x503C;</li>
<li>&#x5229;&#x7528;Es&#x4F7F;&#x5F97;a1-&gt;byte298 == 0x73&#x8F93;&#x51FA;Binggo</li>
</ol>
<p>&#x4E00;&#x5F00;&#x59CB;&#x6211;&#x4ECE;6030e0&#x5F00;&#x59CB;&#x8F93;&#x5165;Binggo&#xFF0C;&#x540E;&#x6765;&#x53D1;&#x73B0;&#x65E0;&#x8BBA;&#x5982;&#x4F55;&#x90FD;&#x65E0;&#x6CD5;&#x5199;&#x5165;00&#xFF0C;&#x770B;&#x5230;&#x5982;&#x4E0B;&#x51FD;&#x6570;&#xFF1A;<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// *(a1-&gt;120+a1-&gt;8) = a1-&gt;299</span></span><br><span class="line"><span class="keyword">signed</span> __int64 __<span class="function">fastcall <span class="title">funcchr8</span><span class="params">(struct_a1 *a1)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="keyword">if</span> ( !a1 || a1-&gt;dword120 &gt;= a1-&gt;dword124 || !a1-&gt;byte299 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  *(_BYTE *)((<span class="keyword">signed</span> <span class="keyword">int</span>)a1-&gt;dword120 + a1-&gt;input_str_encode) = a1-&gt;byte299;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x53D1;&#x73B0;&#x5E76;&#x4E0D;&#x884C;&#xFF0C;&#x6240;&#x4EE5;&#x6362;&#x6E20;&#x9053;&#xFF0C;&#x76F4;&#x63A5;&#x5C06;Binggo&#x5199;&#x5165;6030e0&#x7684;&#x6700;&#x540E;&#x51E0;&#x4E2A;&#x5B57;&#x7B26;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x88AB;6030e0&#x6700;&#x540E;&#x81EA;&#x5DF1;&#x7684;00&#x622A;&#x65AD;&#x5373;&#x53EF;&#x3002;<br>&#x6211;&#x7684;&#x6307;&#x4EE4;&#x5982;&#x4E0B;&#xFF1A;</p>
<blockquote>
<p>;|;}Cc80CH80C&amp;80t(8080C)80totFC%8uuuuuuEs</p>
</blockquote>
<h1 id="&#x88AB;&#x9690;&#x85CF;&#x7684;&#x771F;&#x5B9E;"><a href="#&#x88AB;&#x9690;&#x85CF;&#x7684;&#x771F;&#x5B9E;" class="headerlink" title="&#x88AB;&#x9690;&#x85CF;&#x7684;&#x771F;&#x5B9E;"></a>&#x88AB;&#x9690;&#x85CF;&#x7684;&#x771F;&#x5B9E;</h1><p>&#x597D;&#x5047;&#x7684;&#x9898;&#x76EE;&#xFF0C;&#x91CD;&#x70B9;&#x662F;&#x9898;&#x76EE;&#x7ADF;&#x7136;&#x5077;&#x5077;&#x6362;&#x6389;&#x4E86;memcmp&#x51FD;&#x6570;&#x3002;&#x3002;&#x7EA0;&#x7ED3;<br>&#x9898;&#x76EE;&#x6709;&#x4E09;&#x5173;&#xFF0C;&#x7B2C;&#x4E00;&#x5173;&#x7B2C;&#x4E8C;&#x5173;&#x6BD4;&#x8F83;&#x597D;&#x8FC7;&#xFF0C;&#x76F4;&#x63A5;&#x9006;&#x5411;&#x53EF;&#x4EE5;&#x5F97;&#x51FA;Correct&#x3002;<br>&#x7B2C;&#x4E09;&#x5173;&#x56E0;&#x4E3A;&#x5077;&#x5077;&#x6362;&#x6389;&#x4E86;memcmp&#x51FD;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x6BD4;&#x8F83;&#x90C1;&#x95F7;&#x3002;<br>&#x91CD;&#x70B9;&#x4EE3;&#x7801;verify()&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall Bitcoin::verify(Bitcoin *<span class="keyword">this</span>, <span class="keyword">char</span> *a2)</span><br><span class="line">{</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">void</span> *v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">void</span> *v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [rsp+1Bh] [rbp-85h]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [rsp+1Ch] [rbp-84h]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [rsp+20h] [rbp-80h]</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// [rsp+40h] [rbp-60h]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [rsp+60h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v13; <span class="comment">// [rsp+88h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v13 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( counter == <span class="number">1</span> )</span><br><span class="line">  {</span><br><span class="line">    v2 = *(_DWORD *)a2;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( counter == <span class="number">2</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;::allocator(&amp;v8);</span><br><span class="line">    <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::basic_string(&amp;v11, a2, &amp;v8);</span><br><span class="line">    sha256((__int64)&amp;v12, (__int64)&amp;v11, <span class="number">0</span>);</span><br><span class="line">    v3 = (<span class="keyword">const</span> <span class="keyword">void</span> *)<span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::c_str(&amp;v12, &amp;v11);</span><br><span class="line">    <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(v3, &amp;hashes, <span class="number">0x20</span>uLL) )</span><br><span class="line">      v4 = secret_const[counter];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v4 = *((_DWORD *)<span class="keyword">this</span> + <span class="number">2</span>);</span><br><span class="line">    v2 = v4;</span><br><span class="line">    <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::~basic_string(&amp;v12);</span><br><span class="line">    <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::~basic_string(&amp;v11);</span><br><span class="line">    <span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;::~allocator(&amp;v8);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;::allocator(&amp;v8);</span><br><span class="line">    <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::basic_string(&amp;v10, (__int64)a2, <span class="number">80L</span>L);</span><br><span class="line">    sha256((__int64)&amp;v11, (__int64)&amp;v10, <span class="number">0</span>);</span><br><span class="line">    sha256((__int64)&amp;v12, (__int64)&amp;v11, <span class="number">1</span>);</span><br><span class="line">    v5 = (<span class="keyword">const</span> <span class="keyword">void</span> *)<span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::c_str(&amp;v12, &amp;v11);</span><br><span class="line">    <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(v5, &amp;hashes, <span class="number">32u</span>LL) )</span><br><span class="line">      v6 = secret_const[counter];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v6 = *((_DWORD *)<span class="keyword">this</span> + <span class="number">2</span>);</span><br><span class="line">    v9 = v6;</span><br><span class="line">    <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::~basic_string(&amp;v12);</span><br><span class="line">    <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::~basic_string(&amp;v11);</span><br><span class="line">    <span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::~basic_string(&amp;v10);</span><br><span class="line">    <span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;::~allocator(&amp;v8);</span><br><span class="line">    v2 = v9;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x7B2C;&#x4E09;&#x5173;&#x662F;&#x8F93;&#x5165;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x7136;&#x540E;&#x4E24;&#x6B21;sha256&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;sha256&#x6709;&#x53CD;&#x8F6C;&#xFF0C;&#x6700;&#x540E;&#x548C;hashes&#x6BD4;&#x8F83;&#x5373;&#x53EF;&#xFF0C;&#x4F46;&#x662F;memcmp&#x88AB;&#x6362;&#x6389;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x8DDF;&#x8FDB;&#x53BB;&#xFF0C;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x771F;&#x6B63;&#x8981;&#x6BD4;&#x8F83;&#x7684;&#x503C;&#x662F;&#xFF1A;</p>
<blockquote>
<p>6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000000 </p>
</blockquote>
<p>&#x7F51;&#x9875;&#x641C;&#x7D22;&#x4E00;&#x4E0B;&#xFF0C;&#x5F97;&#x5230;&#x8F93;&#x5165;&#x503C;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0100000000000000000000000000000000000000000000000000000000000000000000003ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4a29ab5f49ffff001d1dac2b7c</span><br></pre></td></tr></table></figure></p>
<p>&#x4F46;&#x662F;&#x63D0;&#x4EA4;&#x4E0D;&#x5BF9;&#xFF0C;&#x8BF4;&#x662F;&#x8981;&#x6700;&#x77ED;&#x8F93;&#x5165;&#xFF0C;&#x66F4;&#x6539;&#x7B2C;&#x4E8C;&#x4E2A;&#x8F93;&#x5165;&#xFF0C;&#x53D1;&#x73B0;0094EA58ADC3AA65F5C26F6ED27D3FDB0D093DC17F8DC81929&#x4E0D;&#x662F;&#x552F;&#x4E00;&#x80FD;&#x901A;&#x8FC7;&#x7B2C;&#x4E8C;&#x5173;&#x7684;&#x503C;&#xFF0C;&#x6700;&#x77ED;&#x662F;&#x7684;&#x503C;&#x662F;0094EA58ADC3AA65F5C26F6ED27D3FDB0D093DC17F&#xFF0C;&#x6CA1;&#x6709;&#x7EC6;&#x7A76;&#xFF0C;&#x62FF;&#x5206;&#x8981;&#x7D27;&#xFF0C; &#x5F97;&#x5230;flag&#xFF1A;</p>
<blockquote>
<p>DDCTF{ea1b1cead2021eea14f8e51c60876c15e518076e79dfb62b952d4a7e623cd01a}</p>
</blockquote>
<h1 id="&#x63A2;&#x5BFB;&#x901D;&#x53BB;&#x7684;Atlantis&#x6587;&#x660E;"><a href="#&#x63A2;&#x5BFB;&#x901D;&#x53BB;&#x7684;Atlantis&#x6587;&#x660E;" class="headerlink" title="&#x63A2;&#x5BFB;&#x901D;&#x53BB;&#x7684;Atlantis&#x6587;&#x660E;"></a>&#x63A2;&#x5BFB;&#x901D;&#x53BB;&#x7684;Atlantis&#x6587;&#x660E;</h1><p>&#x8BE5;&#x9898;&#x5F88;&#x9669;&#xFF0C;&#x5DEE;&#x4E00;&#x70B9;&#x4E22;&#x5206;&#xFF0C;&#x672C;&#x6765;&#x60F3;&#x7740;&#x65E9;&#x70B9;&#x513F;&#x8D77;&#x6765;&#x505A;&#x7684;&#xFF0C;&#x6CA1;&#x60F3;&#x5230;&#x7761;&#x8FC7;&#x4E86;&#x3002;&#x3002;&#x3002;&#x3002;&#x3002;<br>exe&#x6587;&#x4EF6;&#xFF0C;win32&#x5E73;&#x53F0;&#xFF0C;&#x6253;&#x5F00;&#x4E00;&#x770B;&#xFF0C;&#x6709;tls&#x7684;&#x53CD;&#x8C03;&#x8BD5;&#xFF0C;&#x76F4;&#x63A5;&#x53BB;&#x6389;&#x5373;&#x53EF;&#x3002;<br>&#x5F88;&#x53CA;&#x65F6;&#x7684;&#x627E;&#x5230;&#x4E86;&#x5173;&#x952E;&#x70B9;&#xFF0C;&#x672C;&#x6765;&#x4EE5;&#x4E3A;g&#x4E86;&#xFF0C;&#x54C8;&#x54C8;<br>&#x9898;&#x76EE;&#x5229;&#x7528;GlobalAddAtom()&#x51FD;&#x6570;&#x548C;GlobalGetAtom()&#x51FD;&#x6570;&#x6765;&#x4F20;&#x9012;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x4E00;&#x5F00;&#x59CB;&#x4E00;&#x76F4;&#x7ED5;&#x8FDB;01xxxxxx&#x6BB5;&#x91CC;&#x9762;&#x53BB;&#x4E86;&#xFF0C; &#x8DDF;&#x8E2A;&#x5806;&#x6808;&#xFF0C;&#x627E;&#x5230;ReadFile&#x8BFB;&#x53D6;&#x63A7;&#x5236;&#x53F0;&#xFF0C;&#x7136;&#x540E;&#x3002;&#x3002;&#x3002;&#x5F88;&#x6655;&#xFF0C;&#x8FD8;&#x597D;&#x6211;&#x673A;&#x667A;&#x7684;&#x8DF3;&#x4E86;&#x51FA;&#x6765;&#xFF0C;&#x5B9A;&#x4F4D;&#x5230;&#x4E86;&#x5173;&#x952E;&#x70B9;&#xFF1A;<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">_DWORD *__<span class="function">cdecl <span class="title">sub_28F0104</span><span class="params">(_DWORD *a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// ST14_4</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ST04_4</span></span><br><span class="line">  _DWORD *result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [esp+0h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+8h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [esp+10h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = *a1;</span><br><span class="line">  v9 = a1[<span class="number">1</span>];</span><br><span class="line">  v6 = (<span class="keyword">int</span>)(a1 + <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; a3; ++i )</span><br><span class="line">  {</span><br><span class="line">    v8 = (<span class="keyword">unsigned</span> __int8)(v8 + <span class="number">1</span>);</span><br><span class="line">    v3 = *(_DWORD *)(v6 + <span class="number">4</span> * v8);</span><br><span class="line">    v9 = (<span class="keyword">unsigned</span> __int8)(v3 + v9);</span><br><span class="line">    v4 = *(_DWORD *)(v6 + <span class="number">4</span> * v9);</span><br><span class="line">    *(_DWORD *)(v6 + <span class="number">4</span> * v8) = v4;</span><br><span class="line">    *(_DWORD *)(v6 + <span class="number">4</span> * v9) = v3;</span><br><span class="line">    *(_BYTE *)(i + a2) ^= *(_BYTE *)(v6 + <span class="number">4</span> * (<span class="keyword">unsigned</span> __int8)(v4 + v3));</span><br><span class="line">  }</span><br><span class="line">  *a1 = v8;</span><br><span class="line">  result = a1;</span><br><span class="line">  a1[<span class="number">1</span>] = v9;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>a2&#x662F;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#xFF0C;&#x7ECF;&#x8FC7;base64&#x7F16;&#x7801;&#xFF0C;&#xFF08;&#x539F;&#x6765;&#x91CC;&#x9762;&#x641E;&#x6765;&#x641E;&#x53BB;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x8FD9;&#x4E2A;&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x5F02;&#x6216;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x5F97;&#x51FA;&#x7ED3;&#x679C;&#x540E;&#x8DDF;&#x4E0B;&#x9762;&#x7684;&#x6570;&#x5B57;&#x6BD4;&#x8F83;:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> __<span class="function">cdecl <span class="title">sub_28F04A7</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  v3 = <span class="number">-54</span>;</span><br><span class="line">  v4 = <span class="number">-101</span>;</span><br><span class="line">  v5 = <span class="number">-12</span>;</span><br><span class="line">  v6 = <span class="number">101</span>;</span><br><span class="line">  v7 = <span class="number">-60</span>;</span><br><span class="line">  v8 = <span class="number">-49</span>;</span><br><span class="line">  v9 = <span class="number">112</span>;</span><br><span class="line">  v10 = <span class="number">12</span>;</span><br><span class="line">  v11 = <span class="number">74</span>;</span><br><span class="line">  v12 = <span class="number">91</span>;</span><br><span class="line">  v13 = <span class="number">-69</span>;</span><br><span class="line">  v14 = <span class="number">91</span>;</span><br><span class="line">  v15 = <span class="number">40</span>;</span><br><span class="line">  v16 = <span class="number">43</span>;</span><br><span class="line">  v17 = <span class="number">7</span>;</span><br><span class="line">  v18 = <span class="number">-24</span>;</span><br><span class="line">  v19 = <span class="number">-50</span>;</span><br><span class="line">  v20 = <span class="number">-102</span>;</span><br><span class="line">  v21 = <span class="number">0</span>;</span><br><span class="line">  v22 = <span class="number">77</span>;</span><br><span class="line">  v23 = <span class="number">103</span>;</span><br><span class="line">  v24 = <span class="number">-94</span>;</span><br><span class="line">  v25 = <span class="number">-65</span>;</span><br><span class="line">  v26 = <span class="number">19</span>;</span><br><span class="line">  <span class="keyword">return</span> a2 == <span class="number">24</span> &amp;&amp; !<span class="built_in">memcmp</span>(a1, &amp;v3, <span class="number">0x18</span>u);</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x52A8;&#x6001;&#x8C03;&#x8BD5;&#x83B7;&#x53D6; <em>(_BYTE </em>)(v6 + 4 * (unsigned __int8)(v4 + v3));&#x4E2D;&#x7684;&#x5F02;&#x6216;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x7136;&#x540E;&#x5F88;&#x8212;&#x670D;&#xFF1A;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">str = [<span class="number">0x98</span>,<span class="number">0xde</span>,<span class="number">0xa6</span>,<span class="number">0x21</span>,<span class="number">0x92</span>,<span class="number">0x8a</span>,<span class="number">0x2a</span>,<span class="number">0x3b</span>,<span class="number">0x2f</span>,<span class="number">0x13</span>,<span class="number">0xd7</span>,<span class="number">0x6d</span>,<span class="number">0x61</span>,<span class="number">0x51</span>,<span class="number">0x4a</span>,<span class="number">0x82</span>,<span class="number">0x94</span>,<span class="number">0xdd</span>,<span class="number">0x39</span>,<span class="number">0x23</span>,<span class="number">0x3f</span>,<span class="number">0x91</span>,<span class="number">0x8f</span>,<span class="number">0x2e</span>]</span><br><span class="line">str2 =[ <span class="number">0xCA</span>,<span class="number">0x9B</span>, <span class="number">0xF4</span> ,<span class="number">0x65</span>,<span class="number">0xC4</span>,<span class="number">0xCF</span>,<span class="number">0x70</span>,<span class="number">0xC</span>,<span class="number">0x4A</span>,<span class="number">0x5B</span>,<span class="number">0xBB</span>,<span class="number">91</span>,<span class="number">0x28</span>,<span class="number">0x2B</span>,<span class="number">7</span>,<span class="number">0xE8</span>,<span class="number">0xCE</span>,<span class="number">0x9A</span>,<span class="number">0</span>,<span class="number">0x4D</span>,<span class="number">0x67</span>,<span class="number">0xA2</span>,<span class="number">0xBF</span>,<span class="number">0x13</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(str2)):</span><br><span class="line">    <span class="keyword">print</span> chr(str2[i]^str[i]),</span><br></pre></td></tr></table></figure></p>
<p>&#x5F97;&#x51FA;&#x7ED3;&#x679C;RERDVEZ7eHl6IzMjZG9nX30= &#x5373;</p>
<blockquote>
<p>DDCTF{xyz#3#dog_}</p>
</blockquote>
<p>&#x56DE;&#x5934;&#x4E00;&#x770B;&#xFF0C;&#x8FD8;&#x6709;7&#x5206;&#x949F;&#xFF0C;- -</p>
<p>&#x552F;&#x4E00;&#x5F88;&#x9057;&#x61BE;&#x7684;&#x662F;&#x4E0D;&#x80FD;&#x53BB;&#x4EA4;&#x6D41;&#x4F1A;&#xFF0C;&#x77BB;&#x4EF0;&#x5404;&#x4F4D;&#x5927;&#x4F6C;&#xFF0C;&#x54CE;&#xFF0C;web&#x4E00;&#x70B9;&#x4E0D;&#x4F1A;&#xFF0C;&#x83DC;&#x5230;&#x4E0D;&#x884C;</p>
  	
				
	  </div>     
	  

	
<div class="post-meta">
      	

      	
</div>





<div class="post-footer">
  <div class="pf-left">
      <img class="pf-avatar" src="/images/mmexport1514889198540.jpg">
      <p class="pf-des">hi,good good study!</p>
  </div>

  <div class="pf-right">           
      <div class="pf-links">
        




<span class="donate-btn">
	<span class="iconfont icon-donate"></span>
</span>


<div id="donate-box" class="sildeUpMin">

	<span class="donate-cancel iconfont icon-cancel"></span>

	<div class="donate-img-box">
		<img id="donate-qr-wechat" class="donate-img" src="/images/donate1.png" alt="No Donate Image!">	
		<img id="donate-qr-alipay" class="donate-img" src="/images/donate2.png" alt="No Donate Image!">	
	</div>

	<span class="donate-word">&#x4E16;&#x754C;&#x7F8E;&#x597D; &#x4F60;&#x4E5F;&#x662F;</span>

	<div class="donate-list">
		<span class="iconfont icon-donate-wechat"></span>
		<span class="iconfont icon-donate-alipay"></span>
	</div>

</div>

 
        
	
<script id="-mob-share" src="http://f1.webshare.mob.com/code/mob-share.js?appkey=21d601593a1de"></script>
	
	<span class="share-btn">
	<span class="iconfont icon-share"></span>
	</span>


	<div class="-mob-share sildeUpMin">
		   			             
            <a class="iconfont  icon-share-qq -mob-share-qq"></a>		
     	   			             
            <a class="iconfont  icon-share-weixin -mob-share-weixin"></a>		
     	   			             
            <a class="iconfont  icon-share-weibo -mob-share-weibo"></a>		
     	   			             
            <a class="iconfont  icon-share-douban -mob-share-douban"></a>		
     	   			             
            <a class="iconfont  icon-share-facebook -mob-share-facebook"></a>		
     	   			             
            <a class="iconfont  icon-share-twitter -mob-share-twitter"></a>		
     	   			             
            <a class="iconfont  icon-share-google -mob-share-google"></a>		
     	   
	</div>	

      </div>  
    <nav class="pf-paginator">
           
        
      
        
        <a href="/2018/04/04/&#x5F3A;&#x7F51;&#x676F;&#x7684;hide&#x601D;&#x8DEF;&#x89E3;&#x6790;/" data-hover="&#x5F3A;&#x7F51;&#x676F;&#x7684;hide&#x601D;&#x8DEF;&#x89E3;&#x6790;"> Next</a>
            
  </nav>   
  </div>
</div> 
	
	
</article>

          </section> 
      </div>            
    
    <a id="backTop">
      <span>
        <i class="iconfont icon-backtotop"></i>
      </span>
    </a> 

  
    


     <div class="mobile-menu">      

      
      <img class="mobile-menu-icon lazyload" src="/images/placeholder.gif" data-src="/images/favicon.png">   
      

         
            

            <a class="mobile-menu-link" href="/">Home
            </a>
            
         
            

            <a class="mobile-menu-link" href="/archives">Archives
            </a>
            
         
      
</div>        
    


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?636802045446222199ae541e32c8133e"; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>





     
    




<footer id="footer">	    

		
		<div class="footer-copyright">
		&#xA9;
		
		2018		
	
		Lemon
		<br>

		Built By Theme
		<a href="https://github.com/Lemonreds/hexo-theme-Nayo" target="_blank">Nayo</a>	
		</div>			
	 
</footer>   

  

    <script src="/nayo.bundle.js"></script>           
  </body>        
</html>